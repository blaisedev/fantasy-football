# Check out https://docs.codemagic.io/getting-started/building-a-react-native-app/ for more information
# Please review and update values in curly braces

workflows:
    react-native:
        name: React Native App
        environment:
            vars:
                FF_KEYSTORE: Encrypted(Z0FBQUFBQmZ5aWtBaHdsYkl4ZGdFbWo2WFVKLTNzeEZ2RTMtcHhwaVdVWWFOZkR5ODU1OXF6UzlUNU1wbzlZTFlTRlhqaXNfblN1N25MUTctb1hpQ2ZCV2g5dkFyRXoxTmxkOExNVVppUWFhUmdQSGpkaEt3bTJoNjRSUFlkSXdHTnZNYlBaOGtfYnd4QTN1QUpmRHE1NUR2Sy0tWWxZeXI3Z1g5clRnNS1tMTdCT3oxYmR3WDJLWW9QamVHNzFNQTZvU1dfVDdBVTFGMGJkVzFIMXJ3amZEZk5HcHZDeG9vbGVrb3lWYWxOekd2U3labmtaeDRHVEhUQWdQeGs1TXN4UjZFSFBNR3pYTWQ1WXppX294SHRMWjZMNXFhWXhSSzVXRUc3OGVCY0U4NTRGdUpoRkJPYU9UQXdsNUViSUhWTVFyLWk0dUxLdnJpY0xwZjhaYUloNXBld093WUsxcjBKNkpEb1FwdGRtNk9NeXI1UHEtS2NrVHlJSzQ0c3BqYmJtVWk0RjNrWFN0ekgyTlRyaXBXTWdVVWVIWTVQQkxlamNRbnhGSGVXTGx5QXhxOHBLQkVVZ2tSMlp3QkxVY1ZSSjM5WlVwWmlnSmxGNkNWWHBPcGkwUzZqbW4wTlFhVFQyR09yZG5kTUowQnZ1c2lLVHRvUXZHOUN4dHRBSlF1TTNpV3B6eG9mdy1aSEw0eERiYjdSX1k2VlhXUlNsSGNLellsWENUT1dYXzFfbWZldEZlbXdDbmhjaVdBYXBKa0JqcWtaUGwtWGtrSFh5UVE5TUhQT0FSMDhVYkhCWnF2RWtNbXNQQW1aVFZITEJXVTRhNzc2OW41NFZBVk1KdUtZWFBTRmg4ZWItSVJCU3p3NEVaWURKdWR0WUIwVktLUHZsZ2tlcDY5NExvQWRYZkgtVTg3a2dkUU94dFo1SnRveHdSM014cmpPaXJYUnEweXVic2RMb0lHVnZ6eFBZaDc4ZDFHakZUTllFajB3azVWSS1EaDgyRy1rOWdabXRQSHE5OHpqY0VaZ1VqUWxVejZPYWV5X1dsX1lJNElYd0tTSEs4M0FqRTVaeGpwTkRESC1rRHF2Unp4bHJNbFozMVNUZGt5eTJkNV9Wcl8taUl5NDhqdXZZRVc3eXJJMWtBeVJaTEZQWTlWdWJ5RWNPRTA0U0xfZnlkVGpLUHJUWGd5SkRSakRFOTZuRDBTQXdEV25WaXU5Z0hWTGJEVktTTjNTN3RQNEdRMWdsQjFyMkpWc0swclJ0bUVoVFpBN0VrVjk4Rk1pMkZfamptTlhEd19CdEkzdEloUFFiV1gtZ1RVRng2YUliRGhPZndfS0h3cjIxU0ZDeWgyS0x1V1I5SzliX3k5SmE5aVhfcjZjcWlGQzBjanV3WG5fLXBCV28yU0dCVmN0bzRGZVllUEcweXhQaklpM252Q1VEZDM5TDlfVEVfclowOVpHYTRSNzliOU5nLWhnZXZSbVVCU3BXU1FWTzBlRlFDOGNVVGdHREVXN2Y3dDRtRWsybW1lY0dpbk1OMWgxcnRqZTF6Wk5Xak5yMzRaNWhiaDBmSjZpVGZidlM0MmRfdTJLMzBNSEdxNGlRZTNQN3RHVmRFd0EwYkkzS3hVa0ZUeXZUTF9sc0FORWw5eDFuN3MyUTBqTUhZd1NPeDZCN0JROEpsWFNGQzZmdmJPYi14bWZXVS1FT29rNlZFWXZDSEptS1RQRjNVUFZpQWttMmtNTnFGOUVqZDB2MThXby1CdjZCLXcwdVBOLU50eHVOLTNWaTJPWUFQWVBpekRQWlAtSGNVeXA1UG0wUzNwLVJDREd6b3RSN2piX2ktWFRhSnZHT2x6OF81OEp0Y0VoekNPOWQwNVN6ejU4OFNhWEY0all4YngtNFdsbXlGNHlKMEdiNXBIbS1mR0tOanlMck53UU5aTExsUDNCdndYWXFwU2ZqNktHeDRYc2dNdzNDUWhBMlRBMXRDeTVNUW9iMkwwZHMtbDM3QzRYc0pRRUhGd21fQTh4ZVVBTjNyeldBS2dMWTJZeWZJbjY4dlh5NzZ6QlcyZkFVYWFwckRHYlQwelNxd0JPWjJwLXdpcXlqX0t6UXBjM3JUWlBobkxaM0FTazlHS0FlN2dldDFZc0d0Z1cxMTBtMjhoNzUydGxOZy1yREo4SHJnblNTT295dmFLam56aF90bUFENzAxeU5jWUlGQjg2OUZUSlg4TGZZVFNWVWFBRklmelJ2WlAyM3YzNkRZSkVZdXgxZ3RrYjFFZVVuYVV2cGpucnlzalhpSmIyM3d1S2pIc2NVMHFOUTl0dFRhdVlEMnhuXzlWd2d5Y1U3a1FraDJDdnVOTjdIUTZIVl9OU0FVbEh6MXl5WVgyY0JLdmROMU5JelZBckJLSUUtTHk3UXR5emFmY0loVkJRVE1haVh3eHU2QlZUQVhiZDBVcmdYM05JcUdILVkyNHl5cVU4QU1ES2RjRzFsUlBMYUo0WWk5VjBFYWtJZ3c0SENtSFBsdzlTYlNsVjhhcGdxT1RQUU1FZm1MazVMVS1ucnBpbFlhWFJDV0JubndnM3BXR25vaWRTNTJIM0tURjFlUjNJTEZLNFJHTExBRmdpMXVEd1F4YU1RWGU2QkVRTWJKb3NfTWdscHJZbWFiWG1Mbzg4RXE5Z0s1dWJJR0l1bmlEX2Y2eXgzejFncHlDT2pNcWdWalFhblpYMjlrMXVZYTFwYXBBMHVERHJhZmh5T2J5N2xzczlJSEpiRE43dmdzUEw4NU15T3R0ZTdydk0wd05nUjFXU3lmX3pFNHpPUkd2dFFUM09sRzlHRkJWamhmVFVEN3AzSDNKV1VadGU1Wkd0bFpCX1BRbWJneGhmalpROS1qYWNtSmtNZnVicTRZc1JiWUVUM3gxdVdyWTlZd3Vybjdab3JxT0NCQVRMOFpWcTRabEExM1gwSlo4cUlGdm5GMVhTR21nNGNWWDYxXzBSQjBMMk5LbmVpakxReWt2d3BfbnBhcUN5aWI2Q1FTVHhzcjdfbVFRZElELWlpemVYQWl4MTFfc0NXZndzclR2cUNyeGFJcTZpakV2MWw1bnpSLV9aVU5Ud0ZWV1FNNFJmSm5jN2tfQU14TzFaX0t4RjdnNlozWGZuZHpZT1dCM01wMVpFTGRqaGFfRnpDMEZQNGo2MXJuVjc3d2txWlNVQjQ0eUFtTlAydzl5SkpYZndIM1BSb0xfNmtVNDFJQVNzV2lyTzhwRWcwTnBBQjJoNzExR3pvSi1ZOFhPUkdXTWZQMk5RLU8weW1JMVhkRFFLT29wcjlpUzNwQ1JjZld4bVdpc0MyUXotQmtSVTE3RXhuS0Z3MWZDd2dVbDVhY2w3NXRLT0wyc1VoX2dlNGNoQ25oN2lMSm1nWnRWWHB0UHI5TTFVN0FKSnpyeGpQY0tndXhXdERFbHJacGpMOFNTN1JYYUJFVmRDTk1FOVhQZTM4MWdKT015dzJ5MU9mVHR4Q3NVQUdiU1pjMG1oTFh6WTlJSkctVkhSdUF2STk3T1d0T0dhamVTR2pDc1hGTTRjVnpVREtUY1J0T2dMWGlEUDdfMkV5OExuQXBZT3hNQXFhTDl2Tk5MNGFqNTk4cE9QT2VEUVZLUVV5aW53UEVtSFgtMTE4bkxGQ0FTTEY4SE5ZR0hIbWRrbGxfZmtsUllPd2RRTi02Rm1nMElnSFo0aDI2V3dlazNQNHBnY2R2SmU0OHo1ZjU4Unl4czJsVndUbl9mT1lfWHE3azF1TWhXSGs5MWlPR0c3RmZyRnI3enktQ2U1dFVnZ3h0QVotQ19saG54aFBILVpnaVdEbEhHLXFMdUNKZ2t3cjF1dmRub2ZLM3JCeWt3YmxXaEdVQXpMTWR3WEFDc0pEd3Nra2E5OTRtLWI4d25SdkY0S3ZNWGdXVW5HczB6UUFlNnRUd1JJRklJVm9URHVzNHRubl9oVm9LbnJEMEpYaE15dTRvdmRNXzNlUmZ4YVNNNF9LNWxkdkdlbWxaUFI4cmo2YVEzR1FPOXVUdW1qZkp2N0NVclZGNzFYN1pmYVdTLTJCeEZUZzVxb3I0WmNEd2EzU2dheDhZU1o5dXFRMGU5b0pEMUFnZnJzWFZzdVg1enFZOG1qY0pIbTdKUm9HWm1naGFBS0RmbzlOem9oWmhVQmxyY1FVV3pEdWgzM0JqMGV1VUZZNDN4aThDVGtrUnhyYm1zVVJtVTgwOFFDOVFjSHU3Sy1iUzlWSVg1cll6d3hqalhlV1RxWHM0SmFJd1ZLbkE5STFTenc0a2xKdnpPNmFPVUZtZ3RDSk0xYW1ESnhuUFFPbEJpS2xPb3NEcHR4U0drbWtEekIzUlZqcmNoTElGMFpWdE1zSEtyd1V6QnNxdjB3amN6aDZfYVpnc2xtaFhBZG1jaHk3SGF3ei1vZm14eXFYaVJtNmVVbFMwdFRTd09rN1hhNGhRMnZVNGktNTJzdmZWR09SRU91NTZYWHFjYVZXUXo4NmhrNllpWUhnbFIwMUhGWXNyUFhzUHVKdjBrWTlXdW9HR3hXR0l2YmFlNFM4bWlpY3VpWjc1XzdrY3I1RGg5NUs5UjRONTlvVllXZ3IzbERLUVhmREpUbFI0OWNyeVd2MmZUYnBVNzV1Y3BSaTM0QUE5bzhmNlpZYV9qR1ZuSndmNDUwOWZEN2FZYlp6N29jVFVJOFNPMXhhQjJvM0R2cXVHNjdIYkV0bzRJWGNuZ2luMmFxb3RQMjBuaUhVaEg5V0FIWHFQWmY0c2J6QlBfTHhwY0YxaEUtN0VqR0xwNHE5R09ZX2tMUjR0YW03NXdXQmdWa2stS0R1elU2MzUzR1FWNTZOYlRLQlk1VEJCOU9iWkZTZW9EX01zclhHTWY1R3BMdGFLWmhiTy1uaFBzNG1lTk5lb0dkVllYaXBxcmQwcU9FeElQcVdVZU1qb2FpVktwa0Uwb3V2YlVoYW4wVFg5V3RyNzZNRFgtM3JiZENXdjR3aEVPanRISEIwUHh0U3kzbFdJX0NLWUFMTnl0eHhFUDc2djlvbk1EbGlvT0ZtWC1kb01iT0syX1hJOG43SWh0UWRYUlc0TXlJaWM5WWxCWWp4X05ZdWJmTkZXajd3bnFJUm4zUW1tbWNrTjdQQ2dFWjE2NEZhWWtSZFdJbG11bU5WbUtOel9Pc3dQR1hNOFFvRjd2bzBpeE0tR3BRLVNCRmtXSzE0Q3pYVzRyZXJlU0dzc0cwcnJHWmN1WGVpU2xtV1ZWLTd0Z0RtS1FZU2VBUUxFRzdqV3lqRFlwTlZlZC1RV094Uk9WTGU1emgwckNXTGd0bktnajhxNFduN0ZFSUtQS3ZtUzhsRXdMenNKTTgzZlpUY2JxczB2LWdVMThSejV5M1dvaFdZellZelVmX0Y5dzdWTHZEQ283VlotTkRGYUxaMWxZYmVpMXVneGJyWjJOT041Qjd4SmN5X2d2anFVRmdhcmNIMVhCXzluNWFkS3dJbk50dUVaaVJnVTNFZzExN190dUR3SU5Gd2p0elVOY1FBeGNFOWptM1Y5cXZwSUo5a2NUekZiZGJBa2FYQlBNVHpmREQ0RG9sX0FkUEdJZUs4MVMzSHBoWW04eWU5S1BXTS1rWE5idWdnTHNRa053Smk3R0FkN0luc3RTN2ZHNVJLZ1VrNEF2MDZhZlVfVUJMX1VNWThXeFlNd1pUYjFpX3FJTHo1blRqZzdfNVgzWEdGN2Z2OUFKem05VVBGb21DV2JCajkyd3hfYXl6c0JIN0RtQUlHa3ItV0lmYXFOT1p6NGR4emNoUGlHSURYdkxJYUVWZTZnQWJhLU4xOGRNXzhnOVpHYjVueUZseV9HY1JaeEdVUXFMV3dHY09QamEtVDNfQ1h4NlJXUjdkakltLUF5ZXVhcmtzc2RsVE5lVXNCWnBlNkxBSjU2YlNFWkQzZG13bzhUZUdTRUs1RVBGVVRhd0g0amxwaFV0UTFDQURvMHd4RzZDeklfSnIwdFplWVlnQlRaaUV3U2dxZlJKcVdOdFd3amVLTzNJd2hMdTBoZ18zREQ2bmota3ZSTk9iZVBFQXZXYWc4a2dCNUZVWThPTFBqRmJtbXd0aVNadVE2Y20xY2lDTUJBWlFDeWhGcl91M2lPWVVnczEyRHE1Vng5UjJLMVpmUVplRjZXUzRYX2dRZVAyb2FJRm5aQUV3ejVoc3Vlc25GNUE4a25pejladmpHN0JuRmpNYnAzS0Uxc1BVM2NORDVSbzk2WW0tck5PMVh5a0IybU9uTnNGOE1TZkZROHhPOG93LVU5bU5GYmFTLVMtVHpPQThTT2xrNlF4ajdnNU9SdlRLRjUtckZXZjhlcGlnPT0=)
                FF_KEYSTORE_PASSWORD: Encrypted(Z0FBQUFBQmZ5aW1RWm03WWZBNmlRZjhGWTU1Z21feW1rUEtYaG1WOG82dDBJX2RwaDR6b2ltaEt2YzJTMHlnVGlsT2JlVkxfXzdnSEVla3hvMXI2LUZYMTN3MHdrdDZWMmc9PQ==)
                FF_KEY_ALIAS_PASSWORD: Encrypted(Z0FBQUFBQmZ5aW1RWm03WWZBNmlRZjhGWTU1Z21feW1rUEtYaG1WOG82dDBJX2RwaDR6b2ltaEt2YzJTMHlnVGlsT2JlVkxfXzdnSEVla3hvMXI2LUZYMTN3MHdrdDZWMmc9PQ==)
                FF_KEY_ALIAS_USERNAME: Encrypted(Z0FBQUFBQmZ5aW5SeE5LS2U2NGJZYnZXY2dGbW16a0FnMEpwcjUyOU8xZFl5XzlSYjlld3ZDNEkzWTNxNXBMSFhSTnJGaDZCVk9XRDlEV2oydkV4dTBHTENpdDhrX0NsUkI1TG1qNWJoSnA0NGV3YWxPTm16RUU9)
            node: latest
        triggering:
            events:
                - push
                - tag
                - pull_request
            branch_patterns:
                - pattern : master
                  include: true
                  source: true
        scripts:
            - name: Install npm dependencies
              script: |
                  npm install
            - name: Set Android sdk location
              script: |
                  echo "sdk.dir=$HOME/programs/android-sdk-macosx" > "$FCI_BUILD_DIR/android/local.properties"
            - name: Set up Keystore
              script: |
                    echo $FF_KEYSTORE | base64 --decode > /tmp/keystore.keystore
                    cat >> "$FCI_BUILD_DIR/android/key.properties" <<EOF
                    storePassword=$FF_KEYSTORE_PASSWORD
                    keyPassword=$FF_KEY_ALIAS_PASSWORD
                    keyAlias=$FF_KEY_ALIAS_USERNAME
                    storeFile=/tmp/keystore.keystore
                    EOF
            - name: Build Android Release
              script: |
                cd android
                ./gradlew assembleRelease
        artifacts:
            - android/app/build/outputs/**/*.abb
        publishing:
            email:
                recipients:
                    - bdevaney@acquisbi.com
                notify:
                    success: true
                    failure: true